#!/usr/bin/perl -w
#scientist.pl
use strict;

schema();

my @keys = ();
while (my $line = <>) {
    chomp $line;

    if ($line =~ /^scientist_id/)  {
	@keys = split (" ", $line);
	    
next;
}

    my @data = split ("\t", $line);
    for my $datum (@data){
	$datum = "'$datum'";
        $datum =~ s/ /_/g; } #esto cambia los espacios en blanco por _.
    my $keys = join (", ",@keys);
    my $data = join (", ", @data);
    $data =~ s/_/ /g;
    print "INSERT INTO scientist ($keys) VALUES ($data);\n";
}





sub schema {

    print <<END;
    DROP TABLE IF EXISTS scientist;
    CREATE TABLE scientist(
	scientist_id  INT NOT NULL AUTO_INCREMENT,
	mail    VARCHAR(60) NOT NULL,
	first_name VARCHAR (20),
	family_name VARCHAR (20),
	institution VARCHAR (60),
	PRIMARY KEY (scientist_id)
	) ENGINE=InnoDB;

END
;
}
