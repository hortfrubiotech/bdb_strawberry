#!/usr/bin/perl -w
#taxonomy.pl
use strict;

schema();


my @keys = ();
while (my $line = <>) {
    chomp $line;

    if ($line =~ /^tax_id/)  {
	@keys = split (" ", $line);
	    
next;
}

    my @data = split ("\t", $line);
    for my $datum (@data){
	$datum = "'$datum'";
        $datum =~ s/ /_/g; } #esto cambia los espacios en blanco por _.
    my $keys = join (", ",@keys);
    my $data = join (", ", @data);
    $data =~ s/_/ /g;
    print "INSERT INTO taxonomy ($keys) VALUES ($data);\n";
}







sub schema {

    print <<END;
    DROP TABLE IF EXISTS taxonomy;
    CREATE TABLE taxonomy(
    	   tax_id  INT NOT NULL AUTO_INCREMENT,
	   specie  TEXT NOT NULL,
	   var	   TEXT NOT NULL,
	   PRIMARY KEY (tax_id)
	   ) ENGINE=InnoDB;
END
;
}
	   
